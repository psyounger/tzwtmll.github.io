# 安装

```
npm i webpack webpack-cil -D 
```

```js
webpack // 核心编译工具 对所有的特点功能进行功能支持
	> 提供函数导出，将源码给出，直接传参即可
webpack-cil  // 脚手架，会提供一些命令行命令，帮助我们更好操作webpack
	> webpack命令直接调用核心函数的打包功能，降低心智负担0.0
	> state test 等方法，就无需再启动源码
```

## 实现功能

```
按需打包
分包
模块化
可观察的依赖包
不需要按顺序引入
压缩
在es6没有出来的时候就已经实现模块化 __webpack_require__
webpack会产生一个立即执行函数，将index.js作为入口，封装到一个立即执行函数里面(立即执行函数不会污染全局作用域)
treeshaking 
```

> 命令 允许环境

```
npx webpack --config server ./config/webpack.dev.js 
npx webpack --config ./config/webpack.prod.js
```

```
  "scripts": {
    "dev":"npx webpack serve --config ./config/webpack.dev.js",
    "build": "npx webpack --config ./config/webpack.prod.js"
  },
```



# 创建

```js
npm init -y
npx webpack //打包-不指定模式，默认生产模式
npx webpack --mode development //开发模式 自执行
npx webpack --mode prodece //生产模式
```

```js
dist
 > index.html
	// npx webpack 打包生成 main.js 被html引入 默认出口 dist
 	> <script src="main.js"></script> 
```

# entry

```
具有一个或者多个入口
node环境服务器允许,只支持commomjs,导入需要使用require
```

```js
/**
 * @type {import("webpack".Configuration)} //vscode提示
 */
 module.exports = {
  mode: "development",
  entry: "./src/index.js", //指定入口(默认也是这个地址)
  output: {
    clean: true, //打包前删除 dist目录，后续会有hash，最新的
  },   
};
```

```js
//配置方式
1. 单个字符串
react vue spa框架 single page application 单页面应用
入口只有一个，不写也行
2. 多入口
entry: ["./src/a.js", "./src/b.js"],//不推荐，直接引入另一个js
3. 对象main
  entry: {
    main: {
      filename: "pdd.js", // 输出的文件名字
      import: "./src/index.js", // 入口文件
      runtime: "", // 配置当前这个chunk的运行环境
    },
  },
      
```

# output

```
  output: {
    clean: true, //打包前删除 dist目录
    path: path.resolve(__dirname, "dist"),
    filename: "my-first-webpack.bundle.js",
  },
```

# module

```js
npm i css-loader style-loader less-loader sass-loader -D 
css-loader // 导入css
style-loader //创建css
less-loader // 解析 less
sass-loader // 解析 sacc
```

## 处理 css

> test 属性，识别出哪些文件会被转换。

>  use 属性，定义出在进行转换时，应该使用哪个 loader。

```js
module: {
   rules: [
      {
        test: /\.css$/,
        use: ["style-loader"，"css-loader"],
      }
             {
        test: /\.less$/,
        use: ["style-loader", "css-loader", "less-loader"],
      },
      {
        test: /\.s[ac]ss$/,
        use: ["style-loader", "css-loader", "sass-loader"],
      },
    ],
  },
```

## 处理图片

```js
 module: {
   rules: [
      {
        test: /\.(jpg)|(png)|(gif)|(webg)|(svg)$/,
        type: "asset", // 图片有内置
        parser: {
          dataUrlCondition: {
            // 小于10k的图片直接转为存储，减少请求次数
            maxSize: 10 * 1024,
          },
        }, 
        generator:{ // 出口地址
          filename:"static/images/[name]-[hash][ext][query]"
        }
      },
    ],
  },
```

## 处理字体图片音视频等资源 

```js
module: { 
      {
        test: /\.(tft|woff2?|map3|map4|avi)$/,
        type: "asset", // 不做处理
        generator: {
          filename: "static/media/[name]-[hash][ext]",
        },
     },
}
```

## babel环境

`npm i babel-loader @bebal/core @babel/preset-env -D`

> 实现语法降级 xml 环境等功能

```js
module: { 
	{
        test: /\.(js|jsx)/,
        exclude: /node_modules/,
        use: {
          loader: "babel-loader",
          // 下面这段一般是在 .babel 文件中写
          options: {
            preset: ["@babel/preset-dev"],
          },
        },
     },
}     
```

> babel.config.js

```js
module.exports = {
    // 智能预设 js语法降级 或者直接继承官方环境
    presets:["@babel/preset-env"]
};

```



# plugin

### 动态创建html

`npm i html-webpack-plugin -D`

```js
const HtmlWebpackPlugin = require('html-webpack-plugin');
const webpack = require('webpack'); // 用于访问内置插件
 module.exports={
     // 模板
      plugins: [new HtmlWebpackPlugin({ template: './src/index.html' })],
 }

```

### Eslint

`npm i eslint-webpack-plugin`

```js
const EslintPlugin = require("eslint-webpack-plugin")
module.exports ={
	plugins:[
		new EslintPlugin({
			// 检测指定文件 需要有配置文件
			context:path.resoleve(__dirname,'src')
		})
	],
}
```

### .eslintrc.js

```js
module.exports ={
    // 继承规则即可 或手动配置
  // exports: ["eslint:recommended"],
  env: {
    node: true, //开启node的全部变量  console
    browser: true, // 浏览器全局变量  window
  },
  parserOptions: {
    ecmaVersion: 6,
    sourceType: "module", // es模块化
  },
  rules: {
    "no-var": 2, // 不允许使用var
  },
}
```

## 开发服务器

`npm i webpack-dev-server -D`

> 配置

```
module.exports={
  devServer: {
    host:"localhost", // 域名
    port: 3000, // 端口
    open:true // 自动打开
  },
}
```

## 开发与生产的区别

```
开发无输出文件，启动服务器即可
```

